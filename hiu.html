<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Calculator</title>
  <style>
    :root{font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial}
    body{display:flex;align-items:center;justify-content:center;min-height:100vh;background:#f3f4f6;margin:0}
    .calc{width:320px;background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.08);padding:18px}
    .display{height:56px;border-radius:8px;background:#111827;color:#fff;font-size:24px;padding:8px 12px;display:flex;align-items:center;justify-content:flex-end;overflow:hidden}
    .keys{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:14px}
    button{height:56px;border:0;border-radius:8px;font-size:18px;cursor:pointer}
    .btn-op{background:#f59e0b;color:#fff}
    .btn-eq{background:#10b981;color:#fff;grid-column:span 2}
    .btn-clear{background:#ef4444;color:#fff}
    .btn-num{background:#e5e7eb}
    .small{font-size:14px}
  </style>
</head>
<body>
  <div class="calc" role="application" aria-label="Simple calculator">
    <div id="display" class="display" aria-live="polite">0</div>

    <div class="keys">
      <button class="btn-clear small" data-action="clear">C</button>
      <button class="btn-op" data-action="percent">%</button>
      <button class="btn-op" data-action="back">⌫</button>
      <button class="btn-op" data-value="/">÷</button>

      <button class="btn-num" data-value="7">7</button>
      <button class="btn-num" data-value="8">8</button>
      <button class="btn-num" data-value="9">9</button>
      <button class="btn-op" data-value="*">×</button>

      <button class="btn-num" data-value="4">4</button>
      <button class="btn-num" data-value="5">5</button>
      <button class="btn-num" data-value="6">6</button>
      <button class="btn-op" data-value="-">−</button>

      <button class="btn-num" data-value="1">1</button>
      <button class="btn-num" data-value="2">2</button>
      <button class="btn-num" data-value="3">3</button>
      <button class="btn-op" data-value="+">+</button>

      <button class="btn-num" data-value="0">0</button>
      <button class="btn-num" data-value=".">.</button>
      <button class="btn-eq" data-action="equals">=</button>
    </div>
  </div>

  <script>
    const display = document.getElementById('display');
    let expression = '';

    function updateDisplay() {
      display.textContent = expression || '0';
    }

    function append(char) {
      // prevent multiple dots in a number
      if (char === '.') {
        const parts = expression.split(/[^0-9\.]+/);
        const last = parts[parts.length - 1] || '';
        if (last.includes('.')) return;
      }
      expression += char;
      updateDisplay();
    }

    function clearAll() {
      expression = '';
      updateDisplay();
    }

    function backspace() {
      expression = expression.slice(0, -1);
      updateDisplay();
    }

    function percent() {
      try {
        const value = evaluateExpression();
        expression = String(value / 100);
        updateDisplay();
      } catch (e) { display.textContent = 'Error'; }
    }

    function evaluateExpression() {
      // sanitize: allow only digits, operators, decimal point, parentheses
      if (!/^[0-9+\-*/().\s]+$/.test(expression)) throw new Error('Invalid');
      // Use Function instead of eval for slightly safer evaluation
      // Note: this still executes code built from the expression and should be used only locally.
      // Replace × and ÷ if present
      const safeExpr = expression.replace(/×/g, '*').replace(/÷/g, '/');
      // eslint-disable-next-line no-new-func
      return Function(`"use strict"; return (${safeExpr})`)();
    }

    function equals() {
      try {
        const result = evaluateExpression();
        expression = String(result);
        updateDisplay();
      } catch (e) {
        display.textContent = 'Error';
        expression = '';
      }
    }

    document.querySelectorAll('button').forEach(btn => {
      btn.addEventListener('click', () => {
        const val = btn.getAttribute('data-value');
        const action = btn.getAttribute('data-action');
        if (val) append(val);
        else if (action === 'clear') clearAll();
        else if (action === 'back') backspace();
        else if (action === 'percent') percent();
        else if (action === 'equals') equals();
      });
    });

    // keyboard support
    window.addEventListener('keydown', (e) => {
      if (e.key >= '0' && e.key <= '9') append(e.key);
      else if (['+','-','*','/','(',')','.'].includes(e.key)) append(e.key);
      else if (e.key === 'Enter') { e.preventDefault(); equals(); }
      else if (e.key === 'Backspace') backspace();
      else if (e.key === 'Escape') clearAll();
    });

    updateDisplay();
  </script>
</body>
</html>